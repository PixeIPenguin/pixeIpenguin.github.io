<!DOCTYPE html><html> <head> <title>Reverse Engineering [1]: The Basics</title> <link rel="stylesheet" href="/assets/css/post.css"> <link rel="icon" href="/icon.ico"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta charset="UTF-8"> <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script> </head> <body> <nav class="crumbs"> <span><a href="/index.html">Home</a></span> <span><a href="/blog.html">Blog</a></span> <span>Reverse Engineering [1]: The Basics</span> </ol> </nav> <div class="content"> <span class="title"> <h1 class="cmd-effect" id="page-title"><noscript>Reverse Engineering [1]: The Basics</noscript></h1> <p>February 26, 2023</p><div class="tags"> <span>reverse engineering</span> <span>lessons</span> </div></span> <hr/> <div class="post"> <p>Let's address the most common question first: "Is reverse engineering illegal?" Technically, no, reverse engineering is not illegal, but this depends on a variety of factors. Factors such as the country you reside in, the specific laws that apply, and the purpose and method of the reverse engineering may vary whether or not it is legal. There are some cases where reverse engineering may infringe on intellectual property rights or other legal protections. As I am not an expert in law, I recommend that you conduct thorough research on the laws that apply to your specific situation before conducting any reverse engineering activities.</p><p>Another popular question is, "What is reverse engineering?" Reverse engineering is the process of analysing and understanding the inner workings of hardware or software programs by examining their components, functionality, and framework. It is commonly used to gain insights into how things actually work, to release findings or to create something that is compatible with the program or hardware. The process involves breaking down the hardware or program into individual parts and understanding how they work.</p><p>With those questions answered, let us dive into some methods of reverse engineering. There are many methods, but the most popular one is disassembling the application itself. Some other common methods include using hex or text editors, or even running applications while monitoring them. There are two types of reverse engineering tactics: dynamic and static. Static analysis involves analyzing the program without running it, while dynamic analysis involves running the program and monitoring it. You can achieve dynamic analysis by using <a href="https://en.wikipedia.org/wiki/Sandbox_(software_development)">sandboxes</a> or <a href="https://en.wikipedia.org/wiki/Virtual_machine">virtual machines</a> (VMs) to run the program safely.</p><p>Let us go over some of these methods individually, shall we?</p><p>Hex/Text editors:<br/>Hex and text editors are usually used to gather basic information. This information can include strings within the actual program. With knowledge of these strings, you may see there is actually a web-server being reached out to maybe! You may also be able to see much more. A little fun thing you can do with this is editing the string to be something different (as long as the text are equal in length).</p><p>Dynamic Testing:<br/>You do not want to just run the program and see what it does. There are many things to take into consideration. First and foremost, you need a virtual machine or a sandbox. This won't be enough in some cases, as some malware can work in the background. You should use Wireshark and other tools to monitor the following: network traffic, registry keys, memory, storage, and processes. While dynamic testing, you should be monitoring everything. You can look up important registry locations to keep a watch on while running malware. Some files may have anti-VM protection methods. To bypass such methods, you may need to disassemble the file using a disassembler and eventually bypass it. It is sometimes as easy as just returning a false value. Make sure that if you take this route, you have your VM configured properly to avoid damage to your network/machine.</p><p>Other useful information to know about includes PE headers. You may ask, "What is a PE header?" Well, PE stands for "portable executable," which is a file format. PE headers are important as they can give you information about the original device the file was compiled on. For example, some PE headers contain the original file path and even the time zone! However, it is easy to spoof the PE headers, so you should not always trust the information they provide. Keep in mind that many files have PE headers. The most common files include executables, dynamic link libraries, system files, control panels, screen savers, Windows installer files, Windows sidebar gadgets, Windows help files, and Windows themes.</p><p>A deeper look into PE headers:<br/>There are several small sections inside PE headers, and we will focus on the common ones. The .text section contains the executable's code, and the .rdata section holds read-only data that is globally accessible within the program. The .data section stores global data accessed throughout the program, and the .idata section, which is sometimes present, stores import function information. If the .idata section is not present, the import function information is stored in the .rdata section. The .edata section, which is sometimes present, stores export function information. If the .edata section is not present, the export function information is stored in the .rdata section as well. The .pdata section is only present in 64-bit executables and stores exception-handling information. The .rsrc section stores resources needed by the executable, and lastly, the .reloc section contains information for relocation on library files.</p><p>Disassemblers:<br/>There are several disassemblers available, and two well-known ones are IDA Pro and x64dbg. Some languages/frameworks even have a decompiler specifically for them like DnSpy for .NET frameworks. disassemblers work by generating assembly code from the machine executable code. They usually support a variety of executable formats. IDA Pro has a feature called "<a href="https://en.wikipedia.org//wiki/Pseudocode">pseudocode</a>," which shows what the code would look like if it were written in C/C++.</p><p>It is essential to note that it is not always as simple as dumping files into a disassembler to find information about them. Obfuscation or packing methods may cause issues. You may need to find deobfuscators or unpackers that work with the file, or you may need to do it manually.</p><p>Recommended Tools:<br/>Disassemblers: <a href="https://x64dbg.com/">x64dbg</a> or <a href="https://hex-rays.com/ida-pro/">IDA Pro</a>.<br/>Hex/Text Editors: <a href="https://mh-nexus.de/en/hxd/">HxD</a> and <a href="https://notepad-plus-plus.org/downloads/">Notepad++</a>.<br/>For Dynamic Testing: <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox,</a> <a href="any.run">any.run</a>, <a href="https://www.wireshark.org/">Wireshark</a>, <a href="https://processhacker.sourceforge.io/">Process Hacker</a>, <a href="https://personalfirewall.comodo.com/">Comodo Firewall</a>, and <a href="https://kaspersky.com/">Kaspersky</a>. It is not recommended to use VMWare as some vulnerabilities still exist within it today.<br/>PE Viewers: <a href="http://wjradburn.com/software/">PEView</a>.<br/>Import/Export Viewer: <a href="https://www.dependencywalker.com/">DependencyWalker</a>.<br/>Packer Detector: <a href="https://github.com/horsicq/Detect-It-Easy/releases">Detect It Easy</a> or <a href="https://github.com/ExeinfoASL/ASL">A.S.L</a>.<br/>Other tools: <a href="https://www.winitor.com/">pestudio</a>, <a href="virustotal.com">virustotal.com</a>, and <a href="https://www.winmd5.com/">WinMD5</a>.</p></div></div><div class="footer"> <p>Copyright (c) 2022 Luca "PixelPenguin" F.</p></div><script src="/assets/js/typer.js" type="module"></script> </body></html>
